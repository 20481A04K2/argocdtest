global:
  cluster: "kk-1"
  # customSecret: true can be removed, usually just name/key is enough, 
  # but keeping it doesn't hurt if your chart version supports it.
  customSecretName: "newrelic-license"
  customSecretLicenseKey: "license"
  lowDataMode: true
  privileged: true

nri-bundle:
  newrelic-infrastructure:
    enabled: true

  nri-kubernetes:
    enabled: true
    privileged: true

  nri-prometheus:
    enabled: true

  newrelic-logging:
    enabled: true
    lowDataMode: true

  newrelic-infra-operator:
    enabled: true
    # --- FIX STARTS HERE ---
    # The operator crashes without at least one policy defined.
    # We add a specific rule so it only injects if you ask for it.
    config:
      policies:
        - name: "default-policy"
          pod_label: "newrelic-injection"
          pod_label_value: "enabled"
    # --- FIX ENDS HERE ---

  newrelic-prometheus-agent:
    enabled: true
    lowDataMode: true
    config:
      kubernetes:
        integrations_filter:
          enabled: false
